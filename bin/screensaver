#!/usr/bin/perl
use strict;
use warnings;

my $OVERRIDE_FILE = "/tmp/screen-saver-override";

sub writeFile($$);

my $okCmds = join "|", qw(--activate --deactivate --disable);
my $defaultCmd = "--activate";

my $usage = "Usage: $0 [$okCmds] {default is $defaultCmd}\n";

sub main(@){
  my $cmd = shift;
  $cmd = $defaultCmd if not defined $cmd;
  die $usage if @_ != 0;

  if($cmd =~ /^(--activate)$/){
    writeFile $OVERRIDE_FILE, 'on';
  }elsif($cmd =~ /^(--deactivate)$/){
    system "rm", "-f", $OVERRIDE_FILE;
    system "xidlereset";
  }elsif($cmd =~ /^(--disable)$/){
    writeFile $OVERRIDE_FILE, 'off';
  }else{
    die $usage;
  }
}

sub writeFile($$){
  open FH, "> $_[0]" or die "Could not write to $_[0]\n";
  print FH $_[1];
  close FH;
}

&main(@ARGV);
