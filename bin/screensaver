#!/usr/bin/perl
use strict;
use warnings;

sub writeFile($$);

my $OVERRIDE_FILE = "/tmp/screen-saver-override";

my $OK_CMDS = join "|", qw(--activate --deactivate --disable);
my $DEFAULT_CMD = "--activate";

my $USAGE = "Usage: $0 [$OK_CMDS] {default is $DEFAULT_CMD}\n";

sub main(@){
  my $cmd = shift;
  $cmd = $DEFAULT_CMD if not defined $cmd;
  die $USAGE if @_ != 0;

  if($cmd =~ /^(--activate)$/){
    writeFile $OVERRIDE_FILE, 'on';
  }elsif($cmd =~ /^(--deactivate)$/){
    system "rm", "-f", $OVERRIDE_FILE;
    system "xidlereset";
  }elsif($cmd =~ /^(--disable)$/){
    writeFile $OVERRIDE_FILE, 'off';
  }else{
    die $USAGE;
  }
}

sub writeFile($$){
  open FH, "> $_[0]" or die "Could not write to $_[0]\n";
  print FH $_[1];
  close FH;
}

&main(@ARGV);
