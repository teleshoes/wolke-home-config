#!/usr/bin/perl
use strict;
use warnings;

sub getCurSongInfo();
sub getSongInfo($$$);

my $CURSONG_FILE = "$ENV{HOME}/.cache/stepmania-selected-song";

sub main(@){
  getCurSongInfo();
}

sub getCurSongInfo(){
  my $out = `cat $CURSONG_FILE`;
  if($out =~ /^StepsType_(\w+)%%%Difficulty_(\w+)%%%(.+)$/){
    my ($stepsType, $difficulty, $simfile) = ($1, $2, $3);
    getSongInfo($stepsType, $difficulty, $simfile);
  }else{
    die "ERROR: could not parse $CURSONG_FILE\n";
  }
}

sub getSongInfo($$$){
  my ($stepsType, $difficulty, $simfile) = ($1, $2, $3);

  print "$stepsType-$difficulty-$simfile\n";
}

&main(@ARGV);
