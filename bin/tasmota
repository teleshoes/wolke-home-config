#!/usr/bin/perl
use strict;
use warnings;

my $DEFAULT_DEVICE = "outlet1";
my $DEFAULT_COMMAND = "POWER TOGGLE";

my $DEVICES = {
  bulb1   => "192.168.11.93",
  bulb2   => "192.168.11.94",
  bulb3   => "192.168.11.95",
  outlet1 => "192.168.11.96",
  outlet2 => "192.168.11.97",
  outlet3 => "192.168.11.98",
};

sub cmd($$);

sub main(@){
  my ($device, $cmd) = @_;
  $device = $DEFAULT_DEVICE if not defined $device;
  $cmd = $DEFAULT_COMMAND if not defined $cmd;
  cmd $device, $cmd;
}

sub cmd($$){
  my ($device, $cmd) = @_;
  $cmd =~ s/ /%20/g;
  system "curl", "http://$$DEVICES{$device}/cm?cmnd=$cmd";
}

&main(@ARGV);
