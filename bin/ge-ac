#!/usr/bin/python3
import aiohttp
import asyncio
import logging
import sys
from configfile import (USERNAME, PASSWORD, REGION, MAC)

from gehomesdk import (
    EVENT_APPLIANCE_INITIAL_UPDATE,
    GeAppliance,
    GeWebsocketClient,
)

EVENT_LOOP = asyncio.get_event_loop()


async def handle(appliance: GeAppliance):
  pass

async def main():
  client = GeWebsocketClient(USERNAME, PASSWORD, REGION, EVENT_LOOP)
  client.add_event_handler(EVENT_APPLIANCE_INITIAL_UPDATE, handle)

  session = aiohttp.ClientSession()
  asyncio.ensure_future(client.async_get_credentials_and_run(session), loop=EVENT_LOOP)

if __name__ == "__main__":
  EVENT_LOOP.run_until_complete(main())
  EVENT_LOOP.run_forever()
