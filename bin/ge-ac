#!/usr/bin/python3
import aiohttp
import asyncio
import logging
import sys

from gehomesdk import (
    EVENT_APPLIANCE_INITIAL_UPDATE,
    GeAppliance,
    GeWebsocketClient,
)

USERNAME=""
PASSWORD=""
REGION=""

_LOGGER = logging.getLogger(__name__)

async def handle(appliance: GeAppliance):
  pass

def main():
  logging.basicConfig(level=logging.DEBUG, format='%(asctime)-15s %(levelname)-8s %(message)s')

  loop = asyncio.get_event_loop()
  client = GeWebsocketClient(USERNAME, PASSWORD, REGION, loop)
  client.add_event_handler(EVENT_APPLIANCE_INITIAL_UPDATE, handle)

  session = aiohttp.ClientSession()
  asyncio.ensure_future(client.async_get_credentials_and_run(session), loop=loop)
  loop.run_until_complete(asyncio.sleep(60))

  return 0

if __name__ == "__main__":
  sys.exit(main())
