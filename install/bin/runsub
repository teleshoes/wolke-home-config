#!/usr/bin/perl
use strict;
use warnings;
use lib `dirname $0 | tr -d '\n'`;
use ScriptScript;

sub main(@){
  die "Usage: SUB [ARG ARG ..]\n" if @_ == 0;
  my $sub = shift;
  my $subRef;
  eval{ $subRef = \&{$sub} };
  if(not defined $subRef){
    die "ERROR: unknown sub $sub\n";
  }

  my @valArr = &{$subRef}(@_);
  my $val = undef;
  if(@valArr > 1){
    $val = \@valArr;
  }elsif(@valArr == 1){
    $val = $valArr[0];
  }

  if(defined $val){
    if(ref($val) eq 'ARRAY'){
      my @arr = @$val;
      print join(" ", @arr) . "\n";
    }elsif(ref($val) eq 'HASH'){
      my %hash = %$val;
      print join(", ", map {"$_ => $hash{$_}"} sort keys %hash) . "\n";
    }elsif(ref($val) eq 'SCALAR'){
      print $$val . "\n";
    }else{
      chomp $val;
      print "$val\n";
    }
  }
}
&main(@ARGV);
