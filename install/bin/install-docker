#!/usr/bin/perl
use strict;
use warnings;
use lib `dirname $0 | tr -d '\n'`;
use ScriptScript;

sub main(@){
  runAptGet "install", "docker.io";
  tryrunSudo "groupadd", "docker";
  runSudo "usermod", "-aG", "docker", getUsername();

  my %okGroups = map {$_ => 1} split /\s+/, proc "groups";
  my $dockerMaybeIs = defined $okGroups{docker} ? "IS" : "is NOT";
  print "user " . getUsername() . " $dockerMaybeIs in docker group\n";
  if(not defined $okGroups{docker}){
    print "WARNING: logout and login to add docker user\n";
  }
}

&main(@ARGV);
